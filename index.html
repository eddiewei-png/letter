<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Letter Project</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
/* ---------- Base ---------- */
body, html {
  margin: 0; padding: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #fff0f5;
  overflow: hidden;
}

/* ===== Start Page ===== */
.start-wrapper {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  z-index: 100;
}
.start-container { display: flex; flex-direction: column; align-items: center; gap: 12px; text-align: center; }
#click-hint { font-size: 2.4rem; color: #ff69b4; text-shadow: 0 0 8px #ff69b4, 0 0 15px #ff1493; animation: beat 1.2s infinite; pointer-events: none; }
@keyframes beat {0%,100%{transform:scale(1);}50%{transform:scale(1.15);} }
@keyframes wiggle {0%,100%{transform:rotate(0deg);}15%{transform:rotate(-8deg);}30%{transform:rotate(6deg);}45%{transform:rotate(-6deg);}60%{transform:rotate(5deg);}75%{transform:rotate(-3deg);} }
#startBtn { cursor: pointer; border: none; background: none; width: 160px; height: 160px; }
#startBtn img { width: 100%; height: 100%; border-radius: 50%; filter: drop-shadow(0 0 12px rgba(255,105,180,0.7)); animation: wiggle 1.5s infinite ease-in-out; }
.fade-out {animation: fadeOut 1.8s forwards ease-in-out;}
@keyframes fadeOut {from{opacity:1;transform:scale(1);} to{opacity:0; transform:scale(0.8);} }

/* ===== Letter container ===== */
#container {
  opacity: 0;
  pointer-events: none;
  width: min(96vw, 580px); /* slightly larger */
  aspect-ratio: 360 / 650;
  margin: 20px auto;
  border-radius: 12px;
  box-shadow: 0 6px 25px rgba(250,50,120,0.2);
  background: url("stellalou-letter-bg.png") no-repeat center top;
  background-size: cover;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  transition: opacity 1s ease-in;
  z-index: 10;
  overflow: hidden;
}
#container.show { opacity:1; pointer-events:auto; }

/* letter wrapper */
#letter-wrapper {
  flex:1;
  overflow-y:auto;
  padding: clamp(18px, 5vw, 46px);
  box-sizing:border-box;
  scrollbar-width:none;
  display:block;
}
#letter-wrapper::-webkit-scrollbar { display:none; }

/* Smaller letter text */
#letter {
  font-family:'Georgia', serif;
  font-size: clamp(0.95rem, 1.2vw, 1.1rem); /* reduced slightly */
  color:#E8C1E5;
  white-space:pre-wrap;
  position:relative;
  line-height:1.7;
}

/* line containers */
#letter .line { margin-bottom: 1.1em; }
#letter .en, #letter .cn { display:block; }

/* ink trail */
.ink-trail {
  position:absolute; border-radius:50%; pointer-events:none;
  background:radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%);
  opacity:0; transition:all 0.35s ease-out;
  width:6px; height:1.2rem;
  transform:translate(-50%,-10%);
}

/* Our Moments button */
#momentsBtn {
  display:inline-block;
  padding: 10px 20px;
  border-radius: 999px;
  border: 2px solid rgba(255,105,180,0.9);
  background: rgba(255, 255, 255, 0.06);
  color: #ff4da6;
  font-weight:700;
  text-decoration:none;
  font-family: 'Poppins', sans-serif;
  cursor:pointer;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 900ms cubic-bezier(.2,.9,.2,1), transform 600ms ease;
  box-shadow: 0 6px 18px rgba(255,105,180,0.06);
  margin-top: 16px;
  pointer-events: none;
}
#momentsBtn.visible { opacity:1; transform: translateY(0); pointer-events: auto; }

/* Ripple effect */
.ripple { position:fixed; border-radius:50%; background:radial-gradient(circle, rgba(255,20,147,0.8) 0%, rgba(255,20,147,0.3) 70%); width:40px; height:40px; transform:translate(-50%,-50%) scale(1); animation:ripple-anim 4s ease-out forwards; pointer-events:none; z-index:9; }
@keyframes ripple-anim {0%{transform:translate(-50%,-50%) scale(1);opacity:0.7;}100%{transform:translate(-50%,-50%) scale(80);opacity:0;} }

/* Heart */
#heart-container {
  position: fixed;
  left: 50%; top: 50%;
  transform: translate(-50%, -50%);
  width: 100vw; height: 100vh;
  z-index: 50;
  display: none;
  overflow: visible;
}
#heart-container.show { display: block; }
#loveHeart { position: relative; width: 100%; height: 100%; }
#garden { width: 100%; height: 100%; display: block; }

/* Timer text */
#elapseClock { font-family: 'Great Vibes', cursive; font-size: clamp(26px, 6vw, 60px); color: #ff8fb1; text-shadow: 0 0 12px rgba(255,192,203,0.7); opacity: 0; transition: opacity 1.5s ease, transform 1.5s ease; text-align: center; }
#elapseClock .digit { display:inline-block; min-width:30px; text-align:center; transition: transform 0.5s ease, color 0.5s ease; font-weight:700; font-family:'Poppins',sans-serif; }
#elapseClock .digit.pulse { transform: scale(1.2); color:#ff4da6; text-shadow:0 0 12px rgba(255,105,180,0.8); }

@media (max-width: 480px) {
  #container { width: 94vw; max-width: 440px; }
  #letter { font-size: clamp(0.9rem, 2.5vw, 1.05rem); }
}

@media (min-width: 1000px) {
  #container { width: min(70vw, 720px); }
  #letter { font-size: clamp(1rem, 1.1vw, 1.2rem); }
}
</style>
</head>
<body>

<div class="start-wrapper">
  <div class="start-container" id="start-container">
    <div id="click-hint">Click Here <br> ↓</div>
    <button id="startBtn"><img src="stella.png" alt="Start"></button>
  </div>
</div>

<div id="container">
  <div id="letter-wrapper">
    <h1 style="font-family:'Great Vibes', cursive; margin:0 0 .6em 0; font-size: clamp(28px,6vw,40px); color:#ff69b4;">To 静柔</h1>
    <div id="letter"></div>

    <!-- Our Moments button -->
    <div style="text-align:center;">
      <a id="momentsBtn" href="gallery.html" role="button" aria-label="Our Moments">Our Moments</a>
    </div>
  </div>

  <audio id="background-music" loop>
    <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/piano%20music.mp3" type="audio/mpeg">
  </audio>
</div>

<!-- Heart animation -->
<div id="heart-container">
  <div id="loveHeart">
    <canvas id="garden"></canvas>
    <div id="messages">
      <div id="loveMessage">We have been together for</div>
      <div id="elapseClock"></div>
    </div>
  </div>
</div>

<script>
/* (same typing and animation code, just adjusted speed) */
const sentences = [
  ["It's less than 2 months when we first met ","不到两个月前我们才第一次见面"],
  ["Yet it felt like we have known each other for years now","却感觉好像已经认识你好多年了"],
  ["I still remember the first time when we met","我还记得我们初次相遇的那一刻"],
  ["I thought that you're really beautiful","当时我就觉得你真的很美"],
  ["I couldn't even express how happy I am","我无法用言语表达我有多开心"],
  ["but I'm really glad to know you","但我真的很庆幸能认识你"],
  ["It really changes my life so much","因为你，我的生活改变了好多"],
  ["I'm looking forward to our future together!","我很期待我们的未来"],
  ["Let's make more wonderful memories together!","一起创造更多美好的回忆吧"],
  ["- Eddie"]
];
const letterDiv=document.getElementById("letter");
const inkTrails=[];for(let i=0;i<3;i++){const ink=document.createElement("span");ink.classList.add("ink-trail");letterDiv.appendChild(ink);inkTrails.push(ink);}
let trailIndex=0;
function showInkUnder(element){if(!element)return;const ink=inkTrails[trailIndex%inkTrails.length];trailIndex++;const containerRect=letterDiv.getBoundingClientRect();const rect=element.getBoundingClientRect();const left=rect.left+rect.width/2;ink.style.left=(left-containerRect.left)+'px';ink.style.top=(rect.top-containerRect.top+(rect.height*0.15))+'px';ink.style.height=Math.max(10,rect.height*1.0)+'px';ink.style.width=Math.max(6,rect.width*0.6)+'px';ink.style.opacity=1;setTimeout(()=>ink.style.opacity=0,420);}
function createCharSpan(char){const s=document.createElement('span');s.textContent=char;s.style.opacity=0;s.style.transition='opacity 0.5s ease, text-shadow 0.4s ease';return s;}
async function typeLine(enElement,cnElement,done){
  const enText=enElement.textContent||"",cnText=cnElement.textContent||"";
  enElement.textContent="";cnElement.textContent="";
  const lenE=enText.length,lenC=cnText.length;
  const baseDelay=70,jitter=15,endPause=850;
  const enSpans=[...enText].map(createCharSpan),cnSpans=[...cnText].map(createCharSpan);
  enSpans.forEach(s=>enElement.appendChild(s));cnSpans.forEach(s=>cnElement.appendChild(s));
  const steps=Math.max(8,lenE,lenC);
  for(let s=0;s<steps;s++){
    const eCount=Math.round((s/(steps-1||1))*lenE);
    const cCount=Math.round((s/(steps-1||1))*lenC);
    for(let i=0;i<eCount;i++){if(enSpans[i]&&enSpans[i].style.opacity==="0"){enSpans[i].style.opacity=1;showInkUnder(enSpans[i]);}}
    for(let j=0;j<cCount;j++){if(cnSpans[j]&&cnSpans[j].style.opacity==="0"){cnSpans[j].style.opacity=1;showInkUnder(cnSpans[j]);}}
    document.getElementById('letter-wrapper').scrollTop=document.getElementById('letter-wrapper').scrollHeight;
    await new Promise(r=>setTimeout(r,Math.max(25,baseDelay+(Math.random()-0.5)*jitter)));
  }
  await new Promise(r=>setTimeout(r,endPause));done();
}
async function showAllText(){
  const container=document.getElementById("container");
  const letter=document.getElementById("letter");
  for(let i=0;i<sentences.length;i++){
    const [enText,cnText]=sentences[i];
    const lineDiv=document.createElement("div");
    lineDiv.classList.add("line");
    const enSpan=document.createElement("div");
    enSpan.classList.add("en");enSpan.textContent=enText;
    const cnSpan=document.createElement("div");
    cnSpan.classList.add("cn");cnSpan.textContent=cnText;
    lineDiv.appendChild(enSpan);lineDiv.appendChild(cnSpan);
    letter.appendChild(lineDiv);
    await new Promise(resolve=>typeLine(enSpan,cnSpan,resolve));
  }
  const momentsBtn=document.getElementById('momentsBtn');
  setTimeout(()=>momentsBtn.classList.add('visible'),300);
  await new Promise(r=>setTimeout(r,1600));
  document.getElementById("background-music").pause();
  inkTrails.forEach(ink=>ink.style.display="none");
  container.classList.add("fade-out");
  await new Promise(r=>setTimeout(r,3000));
  $("#heart-container").fadeIn();
  startHeartAnimation();
}

/* start + heart code unchanged (keep your original below) */
</script>
</body>
</html>

