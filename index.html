<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Letter for u</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
:root {
  --pink: #ff69b4;
  --light-bg: #fff0f5;
  --white-bg: #ffffffee;
}
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: var(--light-bg);
  color: var(--pink);
  text-align: left;
  position: relative;
  overflow-x: hidden;
}

.full-screen {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: var(--light-bg);
  display: flex; justify-content: center; align-items: center;
  flex-direction: column;
  z-index: 10;
  padding: 20px;
}

#startBtn {
  position: relative;
  overflow: hidden;
  padding: 14px 26px;
  font-size: 1.1rem;
  background-color: var(--pink);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(255, 105, 180, 0.3);
  transition: background 0.3s;
  display: flex;
  align-items: center;
}
#startBtn:hover { background-color: #ff85c1; }

#startBtn img {
  width: 40px;
  height: 40px;
  margin-right: 8px;
}

/* Enhanced water ripple */
.water-ripple {
  position: fixed;
  top: 50%;
  left: 50%;
  border-radius: 50%;
  background: rgba(255,105,180,0.3);
  transform: translate(-50%, -50%) scale(0.2);
  pointer-events: none;
  z-index: 9999;
  filter: blur(12px);
}

@keyframes ripple-bloom {
  0% {
    transform: translate(-50%, -50%) scale(0.2);
    opacity: 0.6;
  }
  50% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.4;
  }
  100% {
    transform: translate(-50%, -50%) scale(3);
    opacity: 0;
  }
}

#container {
  max-width: 90%;
  width: 700px;
  background: var(--white-bg);
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 4px 15px rgba(250,50,120,0.2);
  margin: 80px auto;
  display: none;
  text-align: left;
  position: relative;
  opacity: 0;
  transition: opacity 1.5s ease;
}

#container.fade-in {
  opacity: 1;
}

h1 { font-size: 2rem; margin-bottom: 1rem; }

#letter {
  font-family: 'Great Vibes', cursive;
  font-size: 1.8rem;
  color: var(--pink);
  white-space: pre-wrap;
  position: relative;
}

#letter p {
  margin: 1.2em 0;
  position: relative;
}

#letter p span.letter {
  display: inline-block;
  white-space: pre;
  opacity: 0;
  transform: translateY(5px);
  transition: opacity 0.15s ease, transform 0.15s ease;
}

.ink-trail {
  position: absolute;
  width: 4px;
  height: 1.8rem;
  border-radius: 50%;
  pointer-events: none;
  background: radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%);
  opacity: 0;
  transition: all 0.3s ease-out;
}

#heart { font-size: 2.3rem; color: #ff4d6d; margin-top: 24px; animation: beat 1.2s infinite; text-align: center; }
@keyframes beat { 0%,100% { transform: scale(1); } 50% { transform: scale(1.15); } }

@media (max-width: 600px) {
  h1 { font-size: 1.6rem; }
  #letter p { font-size: 1.4rem; }
  #startBtn { padding: 12px 20px; font-size: 1rem; }
  #container { padding: 20px; margin: 60px 10px; }
  #heart { font-size: 2rem; }
}
</style>
</head>
<body>

<div id="intro" class="full-screen">
  <h1>üíå You have a letter waitingg...</h1>
  <button id="startBtn">
    <img src="stella.png" alt="Start Icon">
    Open the Letter
  </button>
</div>

<div id="container">
  <h1>üíå A Letter for u</h1>
  <div id="letter"></div>
  <div id="heart">‚ù§Ô∏è</div>

  <audio id="background-music" loop>
    <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/YisaYu-LiXian.mp3" type="audio/mpeg">
  </audio>
</div>

<script>
const sentences = [
  "Dear [Their Name],",
  "Wherever you are when you read this, I want you to know something simple and true:",
  "I love you.",
  "Not just sometimes, but deeply and always.",
  "You are my calm in chaos, my spark in silence, and my favorite thought.",
  "This letter is here so you can come back to it anytime you need a reminder.",
  "Whenever you miss me or just want to feel loved, this will say it for you:",
  "I love you. I'm with you. I'm proud of u.",
  "Forever yours,",
  "[Your Name]"
];

const letterDiv = document.getElementById("letter");

// Ink trails
const inkTrails = [];
for(let i=0;i<3;i++){
  const ink = document.createElement("span");
  ink.classList.add("ink-trail");
  letterDiv.appendChild(ink);
  inkTrails.push(ink);
}
let trailIndex = 0;

function writeLetter(span, letter){
  return new Promise(resolve => {
    span.textContent = letter;
    requestAnimationFrame(() => {
      const jitter = (Math.random() * 2 - 1);
      span.style.transform = `translateY(${jitter}px)`;
      span.style.opacity = '1';

      const rect = span.getBoundingClientRect();
      const containerRect = letterDiv.getBoundingClientRect();

      const ink = inkTrails[trailIndex % inkTrails.length];
      ink.style.left = (rect.right - containerRect.left - 1) + 'px';
      ink.style.top = (rect.top - containerRect.top) + 'px';
      ink.style.opacity = 1;
      trailIndex++;
      setTimeout(()=>{ ink.style.opacity = 0; }, 400);
    });
    resolve();
  });
}

async function showSentence(sentence, delay=150){
  const p = document.createElement("p");
  letterDiv.appendChild(p);

  for(let i=0;i<sentence.length;i++){
    const span = document.createElement("span");
    span.classList.add("letter");
    p.appendChild(span);
    await writeLetter(span, sentence[i]);
    await new Promise(r => setTimeout(r, delay));
  }
}

async function showAllText(){
  for(let sentence of sentences){
    await showSentence(sentence, 200);
    await new Promise(r => setTimeout(r, 300));
  }
  inkTrails.forEach(ink=>ink.style.display='none');
}

// Enhanced bloom ripple
function createBloomRipples() {
  const numRipples = 5;
  const baseSize = Math.max(window.innerWidth, window.innerHeight);
  const delayStep = 0.3;

  for (let i = 0; i < numRipples; i++) {
    const ripple = document.createElement("span");
    ripple.className = "water-ripple";

    if(i === 0){
      ripple.style.width = ripple.style.height = baseSize + "px";
      ripple.style.animation = `ripple-bloom 1.5s ease-out 0s forwards`;
    } else {
      ripple.style.width = ripple.style.height = (baseSize - i*60) + "px";
      ripple.style.animation = `ripple-bloom 2.5s ease-out ${i*delayStep}s forwards`;
    }

    document.body.appendChild(ripple);
    setTimeout(() => ripple.remove(), 4000);
  }
}

const startBtn = document.getElementById("startBtn");
startBtn.addEventListener("click", function() {
  createBloomRipples();

  // Delay showing letter page until ripple finishes
  setTimeout(()=>{
    document.getElementById("intro").style.display = "none";
    const container = document.getElementById("container");
    container.style.display = "block";
    requestAnimationFrame(()=>container.classList.add("fade-in"));

    const audio = document.getElementById("background-music");
    audio.play().catch(()=>console.log("Autoplay blocked"));

    showAllText();
  }, 2000); // delay ~2s to let ripples bloom
});
</script>

</body>
</html>
