<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My project</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
body, html {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: 'Segoe UI', sans-serif;
  background: #fff0f5;
  overflow: hidden;
}

/* Start button as circular icon with pulse + glow */
#startBtn {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 140px; height: 140px;
  border: none;
  cursor: pointer;
  background: none;
  z-index: 100;
}
#startBtn img {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  display: block;
  animation: pulse-glow 1.5s infinite;
  filter: drop-shadow(0 0 10px rgba(255,105,180,0.7));
}

/* custom heart shape */
  #heart img {
  width: 80px;   /* adjust size */
  height: 80px;  /* adjust size */
  /*animation: beat-img 1.2s infinite;*/
}

@keyframes beat-img {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.15); }
}

/* Pulse + glow only on circular icon */
@keyframes pulse-glow {
  0% { transform: scale(1); drop-shadow: 0 0 0 rgba(255,105,180,0.6); }
  50% { transform: scale(1.15); drop-shadow: 0 0 40px rgba(255,105,180,0.8); }
  100% { transform: scale(1); drop-shadow: 0 0 0 rgba(255,105,180,0.6); }
}

  /* Click Here hint below start button */
#click-hint {
  position: absolute;
  top: 40%; /* adjust to sit above the start button */
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2rem;           /* bigger font */
  color: #ff69b4;            
  text-align: center;
  font-weight: bold;
  text-shadow: 0 0 8px #ff69b4, 0 0 15px #ff1493; /* glowing effect */
  animation: beat 1.2s infinite;
  cursor: pointer;
  z-index: 101;
}

#click-hint br {
  line-height: 1.2; /* adjust spacing between lines */
}
  
@keyframes beat-glow {
  0%, 100% { transform: translateX(-50%) scale(1); text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4, 0 0 15px #ff69b4; }
  50% { transform: translateX(-50%) scale(1.2); text-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 30px #ff69b4; }
}


  /* Fade out animation */
.fade-out {
  animation: fadeOut 1s forwards;
}

@keyframes fadeOut {
  from { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  to   { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
}

/* Ripple effect */
.ripple {
  position: fixed;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255,20,147,0.8) 0%, rgba(255,20,147,0.3) 70%);
  width: 40px; height: 40px;
  left: 0; top: 0;
  transform: translate(-50%, -50%) scale(1);
  animation: ripple-anim 4s ease-out forwards;
  pointer-events: none;
  z-index: 9;
}
@keyframes ripple-anim {
  0% { transform: translate(-50%, -50%) scale(1); opacity: 0.7; }
  100% { transform: translate(-50%, -50%) scale(80); opacity: 0; }
}

/* Letter container */
#container {
  opacity: 0;
  pointer-events: none;
  position: relative;
  max-width: 90%;
  width: 700px;
  height: 80vh;
  margin: 80px auto;
  background: #ffffffee;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 4px 15px rgba(250,50,120,0.2);
  transition: opacity 1s ease-in;
  text-align: left;
  z-index: 10;
  overflow-y: auto;  /* make scrollable */
}
  /* Hide scrollbar but keep scrolling */
#container::-webkit-scrollbar {
  display: none;  /* Chrome, Safari */
}
#container {
  -ms-overflow-style: none;  /* IE & Edge */
  scrollbar-width: none;     /* Firefox */
}
#container.show { opacity: 1; 
                pointer-events: auto;   /* clickable only when shown */}

#letter { font-family: 'Great Vibes', cursive; font-size: 1.8rem; color: #ff69b4; white-space: pre-wrap; position: relative; }
#letter p { margin: 1.2em 0; position: relative; }
#letter p span.letter { display: inline-block; white-space: pre; opacity: 0; transform: translateY(5px); transition: opacity 0.15s ease, transform 0.15s ease; }
/*.ink-trail { position: absolute; width: 4px; height: 1.8rem; border-radius: 50%; pointer-events: none; background: radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%); opacity: 0; transition: all 0.3s ease-out; }*/
.ink-trail {
  position: absolute;
  border-radius: 50%;
  pointer-events: none;
  background: radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%);
  opacity: 0;
  transition: all 0.3s ease-out;
  width: 4px;      /* initial width, will be overridden by JS */
  height: 1.8rem;  /* initial height, will be overridden by JS */
}

#heart { font-size: 2.3rem; color: #ff4d6d; margin-top: 24px; animation: beat 1.2s infinite; text-align: center; }
@keyframes beat { 0%,100% { transform: scale(1); } 50% { transform: scale(1.15); } }
</style>
</head>
<body>

<!-- Start button -->
<button id="startBtn">
  <img src="stella.png" alt="Start Icon">
</button>

<!-- Indicator -->
  <div id="click-hint">Touch here
  <br>↓
  </div>

<!-- Letter page -->
<div id="container">
  <h1>Sample letter</h1>
  <div id="letter"></div>
  <div id="heart"><img src="stellalou.png" alt="Custom Icon"></div>
  <audio id="background-music" loop>
    <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/%E9%83%81%E5%8F%AF%E5%94%AF%E5%8E%BB%E6%9C%89%E9%A3%8E%E7%9A%84%E5%9C%B0%E6%96%B9%E7%94%B5%E8%A7%86%E5%89%A7%E4%B8%BB%E9%A2%98%E6%9B%B2%E9%AB%98%E9%9F%B3%E8%B4%A8%E6%AD%8C%E8%AF%8D%E7%89%88Yisa%20Yu%20x%20%E5%8E%BB%E6%9C%89%E9%A3%8E%E7%9A%84%E5%9C%B0%E6%96%B9%E5%88%98%E4%BA%A6%E8%8F%B2Liu%20Yifei%E6%9D%8E%E7%8E%B0Li%20Xian%20%E4%B8%BB%E6%BC%94.mp3" type="audio/mpeg">
  </audio>
</div>

<script>
// Letter sentences
const sentences = [
  ["Line 1 行一", "Line 1 English"],
  ["Line 2 行二行二行二行二行二行二行二行二行二行二行二行二行二", "Line 2 English"],
  ["Line 3 行三", "Line 3 English"],
  ["Line 4 行四"],   // single line is still an array
  ["Line 5 行五"],
  ["Line 6 行六"],
  ["Line 7 行七"],
  ["Line 8 行八"],
  ["Line 9 行九"],
  ["[Your Name]"]
];

const letterDiv = document.getElementById("letter");
const inkTrails = [];
for(let i=0;i<3;i++){
  const ink = document.createElement("span");
  ink.classList.add("ink-trail");
  letterDiv.appendChild(ink);
  inkTrails.push(ink);
}
let trailIndex = 0;

/*function writeLetter(span, letter){
  return new Promise(resolve => {
    span.textContent = letter;
    requestAnimationFrame(()=>{
      span.style.opacity = '1';
      const rect = span.getBoundingClientRect();
      const containerRect = letterDiv.getBoundingClientRect();
      const ink = inkTrails[trailIndex % inkTrails.length];
      ink.style.left = (rect.right - containerRect.left - 1)+'px';
      ink.style.top = (rect.top - containerRect.top)+'px';
      ink.style.opacity = 1;
      trailIndex++;
      setTimeout(()=> ink.style.opacity = 0, 400);
    });
    resolve();
  });
}*/
function writeLetter(span, letter) {
  return new Promise(resolve => {
    span.textContent += letter; // append instead of overwrite

    requestAnimationFrame(() => {
      span.style.opacity = '1';

      const containerRect = letterDiv.getBoundingClientRect();
      const range = document.createRange();
      range.setStart(span.firstChild || span, span.textContent.length - 1);
      range.setEnd(span.firstChild || span, span.textContent.length);
      const rect = range.getBoundingClientRect();

      const ink = inkTrails[trailIndex % inkTrails.length];

      ink.style.height = rect.height + 'px';
      ink.style.width  = rect.width / 2 + 'px';
      ink.style.left = (rect.right - containerRect.left) + 'px';
      ink.style.top  = (rect.top - containerRect.top) + 'px';
      ink.style.opacity = 1;
      trailIndex++;

      setTimeout(() => ink.style.opacity = 0, 400);
    });

    resolve();
  });
}

/*async function showSentence(sentence, delay=200){
  const p = document.createElement("p");
  letterDiv.appendChild(p);
  for(let i=0;i<sentence.length;i++){
    const span = document.createElement("span");
    span.classList.add("letter");
    p.appendChild(span);
    await writeLetter(span, sentence[i]);
    await new Promise(r => setTimeout(r, delay));

        // Auto-scroll to bottom while typing
    const container = document.getElementById("container");
    container.scrollTop = container.scrollHeight;
  }
}*/
async function showSentence(lines, delay=200){
  const pContainer = document.createElement("p");
  letterDiv.appendChild(pContainer);

  // make sure lines is always an array
  if (!Array.isArray(lines)) lines = [lines];

  const spans = lines.map(line => {
    const span = document.createElement("span");
    span.style.display = 'block';       // stack vertically
    span.style.marginBottom = '0.2em';  // spacing between lines
    pContainer.appendChild(span);
    return { span, text: line };
  });

  const maxLength = Math.max(...lines.map(l => l.length));

  for (let i = 0; i < maxLength; i++) {
    for (let j = 0; j < spans.length; j++) {
      const { span, text } = spans[j];
      if (i < text.length) await writeLetter(span, text[i]);
    }
    await new Promise(r => setTimeout(r, delay));

    // auto-scroll
    letterDiv.parentElement.scrollTop = letterDiv.parentElement.scrollHeight;
  }
}

/*async function showAllText(){
  for(let s=0;s<sentences.length;s++){
    await showSentence(sentences[s], 200);
    await new Promise(r=>setTimeout(r, 300));
  }
  inkTrails.forEach(ink=>ink.style.display='none');
}*/
async function showAllText(){
  for(let s=0; s<sentences.length; s++){
    await showSentence(sentences[s], 400);
    await new Promise(r=>setTimeout(r, 300));
  }
  inkTrails.forEach(ink=>ink.style.display='none');
}


// Start button click
document.getElementById("startBtn").addEventListener("click", function(e){
  const rect = this.getBoundingClientRect();
  const centerX = rect.left + rect.width/2;
  const centerY = rect.top + rect.height/2;

  // Create 5 ripples
  for(let i=0;i<5;i++){
    const ripple = document.createElement("span");
    ripple.className = 'ripple';
    ripple.style.left = centerX+'px';
    ripple.style.top = centerY+'px';
    ripple.style.animationDelay = `${i*0.3}s`;
    document.body.appendChild(ripple);
    ripple.addEventListener('animationend', ()=> ripple.remove());
  }

  // Hide button and show letter during last ripple
  /*setTimeout(()=>{
    this.style.display='none';
    const container = document.getElementById("container");
    container.classList.add('show');
    document.getElementById("background-music").play().catch(()=>console.log("Autoplay blocked"));
    showAllText();
  }, 1200); // fade in during last ripple */
  setTimeout(()=>{
  this.classList.add('fade-out');
  setTimeout(()=> this.style.display='none', 1000); // wait for fade-out to finish

  const container = document.getElementById("container");
  container.classList.add('show');
  document.getElementById("background-music").play().catch(()=>console.log("Autoplay blocked"));
  showAllText();
}, 1200); // trigger during last ripple
});
</script>

</body>
</html>

























