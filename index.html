<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Letter Project ‚Äî Flower Heart</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
  html,body{
    margin:0;padding:0;height:100%;
    background:#fff0f5;
    overflow:hidden;
    font-family:'Segoe UI',sans-serif;
  }

  /* üå∏ START SCREEN */
  .start-wrapper{
    position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
    display:flex;flex-direction:column;align-items:center;gap:12px;
    z-index:4000;
    transition:opacity 1s ease;
  }
  .start-wrapper.fade-out{opacity:0;pointer-events:none;}

  #click-hint{
    font-size:2.4rem;color:#ff69b4;
    text-shadow:0 0 8px #ff69b4,0 0 15px #ff1493;
    pointer-events:none;animation:beat 1.2s infinite;
  }
  @keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}
  #startBtn{cursor:pointer;border:0;background:none;width:160px;height:160px}
  #startBtn img{width:100%;height:100%;border-radius:50%;
    filter:drop-shadow(0 0 12px rgba(255,105,180,0.7));
    animation:wiggle 1.5s infinite;
  }
  @keyframes wiggle{
    0%,100%{transform:rotate(0)}
    15%{transform:rotate(-8deg)}
    30%{transform:rotate(6deg)}
    45%{transform:rotate(-6deg)}
    60%{transform:rotate(5deg)}
    75%{transform:rotate(-3deg)}
  }

  /* ‚úâÔ∏è LETTER CONTAINER */
  #container{
    position:relative;
    width:90vw;max-width:360px;aspect-ratio:360/650;
    margin:20px auto;border-radius:12px;
    box-shadow:0 4px 15px rgba(250,50,120,0.2);
    background:url("stellalou-letter-bg.png") no-repeat center top;
    background-size:100% 100%;
    display:flex;flex-direction:column;overflow:hidden;
    opacity:0;pointer-events:none;transition:opacity 1s ease-in;
    z-index:1000;
  }
  #container.show{opacity:1;pointer-events:auto;}

  /* üîÑ fade-out to pink glow */
  @keyframes fadeOutToPink{
    0%{opacity:1;background-color:transparent;}
    80%{opacity:0.4;background-color:rgba(255,182,193,0.4);}
    100%{opacity:0;background-color:rgba(255,182,193,0.6);}
  }
  #container.fade-out{
    animation:fadeOutToPink 3s ease forwards;
  }

  #letter-wrapper{flex:1;overflow-y:auto;padding:40px;box-sizing:border-box}
  #letter{font-family:'Georgia',serif;font-size:1.4rem;color:#E8C1E5;white-space:pre-wrap;position:relative}
  .ink-trail{
    position:absolute;border-radius:50%;pointer-events:none;
    background:radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%);
    opacity:0;transition:all .3s ease-out;width:4px;height:1.8rem;
  }

  /* Ripple */
  .ripple{
    position:fixed;border-radius:50%;
    background:radial-gradient(circle, rgba(255,20,147,0.8) 0%, rgba(255,20,147,0.3) 70%);
    width:40px;height:40px;transform:translate(-50%,-50%) scale(1);
    animation:ripple-anim 4s ease-out forwards;pointer-events:none;z-index:3500;
  }
  @keyframes ripple-anim{
    0%{transform:translate(-50%,-50%) scale(1);opacity:.7}
    100%{transform:translate(-50%,-50%) scale(80);opacity:0}
  }

  /* üíñ HEART FRAME */
  #heart-frame{
    position:fixed;inset:0;
    display:flex;justify-content:center;align-items:center;
    background:rgba(255,240,245,0.6);
    opacity:0;pointer-events:none;
    z-index:2000;transition:opacity 0.6s ease;
  }
  #heart-frame.show{opacity:1;}
  @keyframes gentleGlow{
    0%,100%{transform:scale(1);filter:drop-shadow(0 0 6px #f48fb1);}
    50%{transform:scale(1.02);filter:drop-shadow(0 0 12px #ffb6c1);}
  }
  #heart-frame.finished{animation:gentleGlow 3s ease-in-out infinite;}

  /* üå∏ Flower emoji */
  .flower{
    position:absolute;font-size:22px;
    opacity:0;
    transform:translate(-50%,-50%) scale(.8);
    transition:opacity .28s ease,transform .28s ease;
    pointer-events:none;
  }
</style>
</head>
<body>

  <!-- üå∏ START SCREEN -->
  <div class="start-wrapper" id="start-wrapper">
    <div id="click-hint">Click Here ‚Üì</div>
    <div class="start-container" id="start-container">
      <button id="startBtn"><img src="stella.png" alt="Start"></button>
    </div>
  </div>

  <!-- ‚úâÔ∏è LETTER -->
  <div id="container">
    <div id="letter-wrapper">
      <h1>Sample Letter</h1>
      <div id="letter"></div>
    </div>
    <audio id="background-music" loop>
      <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/piano%20music.mp3" type="audio/mpeg">
    </audio>
  </div>

  <!-- üíñ HEART -->
  <div id="heart-frame"></div>

<script>
/* ---------------- Letter typing ---------------- */
const sentences=[
  ["Line 1 Ë°å‰∏Ä","Line 1 English"],
  ["Line 2 Ë°å‰∫åË°å‰∫åË°å‰∫å Line 2 English Ë°å‰∫åË°å‰∫åË°å‰∫å","Line 2 English Ë°å‰∫åË°å‰∫åË°å‰∫å Line 2 English"],
  ["Line 3 Ë°å‰∏â","Line 3 English"],
  ["[Your Name]"]
];
const letterDiv=document.getElementById("letter");
const inkTrails=[];
for(let i=0;i<3;i++){
  const ink=document.createElement("span");
  ink.className="ink-trail";
  letterDiv.appendChild(ink);
  inkTrails.push(ink);
}
let trailIndex=0;
function writeLetter(span,letter){
  return new Promise(resolve=>{
    span.textContent+=letter;
    requestAnimationFrame(()=>{
      span.style.opacity="1";
      const containerRect=letterDiv.getBoundingClientRect();
      const range=document.createRange();
      range.setStart(span.firstChild||span,span.textContent.length-1);
      range.setEnd(span.firstChild||span,span.textContent.length);
      const rect=range.getBoundingClientRect();
      const ink=inkTrails[trailIndex%inkTrails.length];
      ink.style.height=rect.height+"px";
      ink.style.width=rect.width/2+"px";
      ink.style.left=(rect.right-containerRect.left)+"px";
      ink.style.top=(rect.top-containerRect.top)+"px";
      ink.style.opacity=1;
      trailIndex++;
      setTimeout(()=>ink.style.opacity=0,400);
    });
    resolve();
  });
}
async function showSentence(lines,delay=200){
  const p=document.createElement("p");
  letterDiv.appendChild(p);
  if(!Array.isArray(lines)) lines=[lines];
  const spans=lines.map(line=>{
    const s=document.createElement("span");
    s.style.display="block";
    s.style.marginBottom=".2em";
    p.appendChild(s);
    return{span:s,text:line};
  });
  const maxLen=Math.max(...lines.map(l=>l.length));
  for(let i=0;i<maxLen;i++){
    for(const{span,text}of spans){
      if(i<text.length)await writeLetter(span,text[i]);
    }
    await new Promise(r=>setTimeout(r,delay));
    letterDiv.parentElement.scrollTop=letterDiv.parentElement.scrollHeight;
  }
}
async function showAllText(){
  for(let s=0;s<sentences.length;s++){
    await showSentence(sentences[s],300);
    await new Promise(r=>setTimeout(r,300));
  }
  inkTrails.forEach(t=>t.remove());
  const container=document.getElementById("container");
  container.classList.add("fade-out");
  await new Promise(r=>setTimeout(r,3000));
  const heartFrame=document.getElementById("heart-frame");
  heartFrame.classList.add("show");
  drawHeartWithFlowers();
}

/* ---------------- Start Button ---------------- */
let animationStarted=false;
document.getElementById("startBtn").addEventListener("click",function(){
  if(animationStarted)return;
  animationStarted=true;
  const rect=this.getBoundingClientRect();
  const cx=rect.left+rect.width/2;
  const cy=rect.top+rect.height/2;
  for(let i=0;i<5;i++){
    const r=document.createElement("span");
    r.className="ripple";
    r.style.left=cx+"px";
    r.style.top=cy+"px";
    r.style.animationDelay=`${i*0.25}s`;
    document.body.appendChild(r);
    r.addEventListener("animationend",()=>r.remove());
  }

  const startWrapper=document.getElementById("start-wrapper");
  startWrapper.classList.add("fade-out");

  setTimeout(()=>{
    startWrapper.style.display="none";
    document.getElementById("container").classList.add("show");
    document.getElementById("background-music").play().catch(()=>{});
    showAllText();
  },1600);
});

/* ---------------- Heart Drawing ---------------- */
async function drawHeartWithFlowers() {
  const heartFrame = document.getElementById('heart-frame');
  heartFrame.innerHTML = ''; // clear previous
  const width = heartFrame.clientWidth;
  const height = heartFrame.clientHeight;

  const scale = Math.min(width, height) / 3; // keeps heart centered and sized well
  const centerX = width / 2;
  const centerY = height / 2 + 50; // a little lower looks nicer

  const targetFlowers = 400;
  const delayPerFlower = 12;

  for (let i = 0; i < targetFlowers; i++) {
    // parametric heart curve for smooth outline filling
    const t = Math.random() * Math.PI * 2;
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);

    // add some randomness inside the heart
    const jitterX = (Math.random() - 0.5) * 1.5;
    const jitterY = (Math.random() - 0.5) * 1.5;

    const px = centerX + (x + jitterX) * scale * 0.05;
    const py = centerY - (y + jitterY) * scale * 0.05;

    const flower = document.createElement('div');
    flower.className = 'flower';
    flower.textContent = 'üå∏';
    flower.style.left = px + 'px';
    flower.style.top = py + 'px';
    heartFrame.appendChild(flower);

    await new Promise(r => setTimeout(r, delayPerFlower));
    flower.style.opacity = '1';
    flower.style.transform = `translate(-50%, -50%) scale(1) rotate(${Math.random() * 40 - 20}deg)`;
  }

  // after done, gentle glowing effect
  heartFrame.classList.add('finished');
}


</script>
</body>
</html>


