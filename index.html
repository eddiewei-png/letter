<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Letter Project</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
body, html {
  margin:0; padding:0;
  font-family:'Segoe UI',sans-serif;
  background:#fff0f5;
  overflow:hidden;
}

/* üå∑ Start wrapper always above everything until hidden */
.start-wrapper {
  position: fixed; /* fixed ensures always centered and above */
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 3000; /* must be above heart and container */
}

.start-container { display:flex; flex-direction:column; align-items:center; gap:12px; text-align:center; }
#click-hint { font-size:2.4rem; color:#ff69b4; text-shadow:0 0 8px #ff69b4,0 0 15px #ff1493; animation:beat 1.2s infinite; pointer-events:none; }
@keyframes beat {0%,100%{transform:scale(1);}50%{transform:scale(1.15);}}

/* Start button wiggle */
@keyframes wiggle {0%,100%{transform:rotate(0deg);}15%{transform:rotate(-8deg);}30%{transform:rotate(6deg);}45%{transform:rotate(-6deg);}60%{transform:rotate(5deg);}75%{transform:rotate(-3deg);} }
#startBtn { cursor:pointer; border:none; background:none; width:160px; height:160px; }
#startBtn img { width:100%; height:100%; border-radius:50%; filter: drop-shadow(0 0 12px rgba(255,105,180,0.7)); animation:wiggle 1.5s infinite ease-in-out; }

/* Fade out */
.fade-out {animation:fadeOut 1.8s forwards ease-in-out;}
@keyframes fadeOut {from{opacity:1;transform:scale(1);} to{opacity:0; transform:scale(0.8);}}

/* Letter container */
#container {
  opacity: 0;
  pointer-events: none;
  width: 90vw;                /* scale with screen width */
  max-width: 360px;           /* don‚Äôt exceed original size */
  aspect-ratio: 360 / 650;    /* keeps the image proportion correct */
  margin: 20px auto;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(250,50,120,0.2);

  background: url("stellalou-letter-bg.png") no-repeat center top;
  background-size: 100% 100%;  /* always fill the container */
  background-color: transparent;

  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  transition: opacity 1s ease-in;
  z-index: 10;
  overflow: hidden;
}
#container.show { opacity:1; pointer-events:auto; }

#letter-wrapper {
  flex:1; 
  overflow-y:auto;
  padding:40px;
  box-sizing:border-box;
  scrollbar-width:none;
}
#letter-wrapper::-webkit-scrollbar { display:none; }

#letter { font-family:'Georgia', serif; font-size:1.4rem; color:#E8C1E5; white-space:pre-wrap; position:relative; }
#letter p { margin:1.2em 0; position:relative; }
#letter p span.letter { display:inline-block; opacity:0; transform:translateY(5px); transition:opacity 0.15s ease, transform 0.15s ease; }

/* Ink trail */
.ink-trail { position:absolute; border-radius:50%; pointer-events:none; background:radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%); opacity:0; transition:all 0.3s ease-out; width:4px; height:1.8rem; }

/* Heart icon */
#heart { text-align:center; margin-top:24px; }
#heart img { width:80px; height:80px; animation:beat-img 1.2s infinite; }
@keyframes beat-img {0%,100%{transform:scale(1);}50%{transform:scale(1.15);}}

/* Ripple */
.ripple { position:fixed; border-radius:50%; background:radial-gradient(circle, rgba(255,20,147,0.8) 0%, rgba(255,20,147,0.3) 70%); width:40px; height:40px; transform:translate(-50%,-50%) scale(1); animation:ripple-anim 4s ease-out forwards; pointer-events:none; z-index:9; }
@keyframes ripple-anim {0%{transform:translate(-50%,-50%) scale(1);opacity:0.7;}100%{transform:translate(-50%,-50%) scale(80);opacity:0;}}

/* ‚ù§Ô∏è Heart Frame Animation */
@keyframes drawHeart {
  from { stroke-dashoffset: 1000; }
  to { stroke-dashoffset: 0; }
}

@keyframes fadeIn {
  to { opacity: 1; }
}

@keyframes bloom {
  0% { transform: scale(0); opacity: 0; }
  60% { transform: scale(1.2); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

/* When heart shows */
#heart-frame.show {
  animation: fadeIn 1s ease forwards;
}

#heart-frame.show path {
  animation: drawHeart 6s ease forwards;
  filter: drop-shadow(0 0 6px #f48fb1);
}

#heart-frame.show circle {
  animation: bloom 1s ease forwards;
}

/* Flowers bloom one by one */
#heart-frame.show circle:nth-child(1) { animation-delay: 4s; }
#heart-frame.show circle:nth-child(2) { animation-delay: 4.5s; }
#heart-frame.show circle:nth-child(3) { animation-delay: 5s; }
#heart-frame.show circle:nth-child(4) { animation-delay: 5.5s; }
#heart-frame.show circle:nth-child(5) { animation-delay: 6s; }

/* ‚ú® Gentle floating and glowing effect after heart is drawn */
@keyframes gentleGlow {
  0%, 100% {
    transform: translateX(-50%) scale(1);
    filter: drop-shadow(0 0 6px #f48fb1);
  }
  50% {
    transform: translateX(-50%) scale(1.03);
    filter: drop-shadow(0 0 12px #ffb6c1);
  }
}

/* Apply the glow once drawing is done */
#heart-frame.finished {
  animation: gentleGlow 3s ease-in-out infinite;
}

/* üåô Letter fade-out effect */
/* üå∏ Fade the letter page into a soft pink glow */
@keyframes fadeOutToPink {
  0% {
    opacity: 1;
    background-color: transparent;
    filter: brightness(1);
  }
  80% {
    opacity: 0.3;
    background-color: rgba(255, 182, 193, 0.4);
    filter: brightness(1.2);
  }
  100% {
    opacity: 0;
    background-color: rgba(255, 182, 193, 0.6);
    filter: brightness(1.4);
  }
}

/* Apply fade effect to the whole letter area */
#container.fade-out {
  animation: fadeOutToPink 3s ease forwards;
}

/* üå∏ Heart frame container ‚Äî start hidden, never block clicks */
#heart-frame {
  position: fixed;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  z-index: 0; /* below start wrapper */
  background: rgba(255,240,245,0.6);
  transition: opacity 1s ease;
}

#heart-frame.show {
  opacity: 1;
  pointer-events: none;
  z-index: 2000; /* bring forward only after letter fades */
}

/* üå∑ Small flower style */
.flower {
  position: absolute;
  width: 22px;
  height: 22px;
  background-image: url('https://upload.wikimedia.org/wikipedia/commons/1/16/Emoji_u1f33c.svg'); /* üå∏ daisy emoji SVG */
  background-size: cover;
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.8);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

</style>
</head>
<body>

<div class="start-wrapper">
  <div class="start-container" id="start-container">
    <div id="click-hint">Click Here <br> ‚Üì</div>
    <button id="startBtn"><img src="stella.png" alt="Start"></button>
  </div>
</div>

<div id="container">
  <div id="letter-wrapper">
    <h1>Sample Letter</h1>
    <div id="letter"></div>
  </div>
  <audio id="background-music" loop>
    <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/piano music.mp3" type="audio/mpeg">
  </audio>
</div>
  
<div id="heart-frame">
  <svg viewBox="0 0 200 180" xmlns="http://www.w3.org/2000/svg">
    <path id="heart-path"
      d="M100,170 C-40,60 60,-20 100,50 C140,-20 240,60 100,170"
      fill="none" stroke="#e91e63" stroke-width="2" stroke-linecap="round" />
  </svg>
</div>
<script>
// Sample sentences
const sentences=[
  ["Line 1 Ë°å‰∏Ä","Line 1 English"],
  ["Line 2 Ë°å‰∫åË°å‰∫åË°å‰∫å Line 2 English Ë°å‰∫åË°å‰∫åË°å‰∫å","Line 2 English Ë°å‰∫åË°å‰∫åË°å‰∫å Line 2 English"],
  ["Line 3 Ë°å‰∏â","Line 3 English"],
  ["[Your Name]"]
];

const letterDiv=document.getElementById("letter");
const inkTrails=[];
for(let i=0;i<3;i++){
  const ink=document.createElement("span");
  ink.classList.add("ink-trail");
  letterDiv.appendChild(ink);
  inkTrails.push(ink);
}
let trailIndex=0;

function writeLetter(span,letter){
  return new Promise(resolve=>{
    span.textContent+=letter;
    requestAnimationFrame(()=>{
      span.style.opacity='1';
      const containerRect=letterDiv.getBoundingClientRect();
      const range=document.createRange();
      range.setStart(span.firstChild||span,span.textContent.length-1);
      range.setEnd(span.firstChild||span,span.textContent.length);
      const rect=range.getBoundingClientRect();
      const ink=inkTrails[trailIndex%inkTrails.length];
      ink.style.height=rect.height+'px';
      ink.style.width=rect.width/2+'px';
      ink.style.left=(rect.right-containerRect.left)+'px';
      ink.style.top=(rect.top-containerRect.top)+'px';
      ink.style.opacity=1;
      trailIndex++;
      setTimeout(()=>ink.style.opacity=0,400);
    });
    resolve();
  });
}

async function showSentence(lines,delay=200){
  const pContainer=document.createElement("p");
  letterDiv.appendChild(pContainer);
  if(!Array.isArray(lines)) lines=[lines];
  const spans=lines.map(line=>{
    const span=document.createElement("span");
    span.style.display='block';
    span.style.marginBottom='0.2em';
    pContainer.appendChild(span);
    return {span,text:line};
  });
  const maxLength=Math.max(...lines.map(l=>l.length));
  for(let i=0;i<maxLength;i++){
    for(let {span,text} of spans){
      if(i<text.length) await writeLetter(span,text[i]);
    }
    await new Promise(r=>setTimeout(r,delay));
    letterDiv.parentElement.scrollTop=letterDiv.parentElement.scrollHeight;
  }
}

async function showAllText() {
  for (let s = 0; s < sentences.length; s++) {
    await showSentence(sentences[s], 300);
    await new Promise(r => setTimeout(r, 300));
  }

  inkTrails.forEach(ink => ink.remove());

  const container = document.getElementById("container");
  container.classList.add("fade-out");

  await new Promise(r => setTimeout(r, 3000));

  const heart = document.getElementById("heart-frame");
  heart.classList.add("show");

  // üå∑ draw with flowers
  drawHeartWithFlowers();
}


// üåü After heart finishes drawing, add glowing animation
setTimeout(() => {
  const heart = document.getElementById("heart-frame");
  if (heart.classList.contains("show")) {
    heart.classList.add("finished");
  }
}, 8500); // wait ~8.5s after draw starts


// Start button click
document.getElementById("startBtn").addEventListener("click",function(){
  const container=document.getElementById("container");
  const startContainer=document.getElementById("start-container");

  this.disabled=true;
  this.style.pointerEvents="none";

  // Ripple effect
  const rect=this.getBoundingClientRect();
  const centerX=rect.left+rect.width/2;
  const centerY=rect.top+rect.height/2;
  for(let i=0;i<5;i++){
    const ripple=document.createElement("span");
    ripple.className='ripple';
    ripple.style.left=centerX+'px';
    ripple.style.top=centerY+'px';
    ripple.style.animationDelay=`${i*0.3}s`;
    document.body.appendChild(ripple);
    ripple.addEventListener('animationend',()=>ripple.remove());
  }

  // Fade out start button
  startContainer.classList.add('fade-out');
  setTimeout(()=>{
    startContainer.style.display='none';
    container.classList.add('show');   // show container first
    document.getElementById("background-music").play().catch(()=>console.log("Autoplay blocked"));
    showAllText();                     // then start text animation
  },1800);
});

// üå∏ Draw heart with flowers
function drawHeartWithFlowers() {
  const heartFrame = document.getElementById("heart-frame");
  const path = document.getElementById("heart-path");
  const svg = heartFrame.querySelector("svg");
  const bbox = svg.viewBox.baseVal;
  const length = path.gefunction drawHeartWithFlowers() {
  const heartFrame = document.getElementById("heart-frame");
  const path = document.getElementById("heart-path");
  const svg = heartFrame.querySelector("svg");
  const bbox = svg.viewBox.baseVal;
  const length = path.getTotalLength();

  // Hide the stroke ‚Äî we only want flowers to be visible
  path.style.stroke = "none";

  const flowerCount = 80;   // more flowers = smoother heart
  const duration = 6000;    // 6 seconds total draw time

  for (let i = 0; i < flowerCount; i++) {
    const flower = document.createElement("div");
    flower.className = "flower";
    flower.style.opacity = 0;
    flower.style.transform = "translate(-50%, -50%) scale(0)";
    heartFrame.appendChild(flower);

    // progressively show flowers along the path
    setTimeout(() => {
      const progress = i / (flowerCount - 1);
      const point = path.getPointAtLength(progress * length);
      flower.style.left = `calc(50% - ${bbox.width/2 - point.x}px)`;
      flower.style.top = `calc(50% - ${bbox.height/2 - point.y}px)`;
      flower.style.transition = "opacity 0.5s ease, transform 0.5s ease";
      flower.style.opacity = 1;
      flower.style.transform = "translate(-50%, -50%) scale(1) rotate(" + (Math.random() * 30 - 15) + "deg)";
    }, (duration / flowerCount) * i);
  }

  // When done, make them gently pulse / glow
  setTimeout(() => {
    heartFrame.classList.add("finished");
  }, duration + 500);
}
  
</script>
</body>
</html>

















