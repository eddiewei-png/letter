<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>A Letter for u</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
<style>
  :root {
    --pink: #ff69b4;
    --light-bg: #fff0f5;
    --white-bg: #ffffffee;
  }
  *{box-sizing:border-box;margin:0;padding:0}

  body{
    font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background:var(--light-bg);
    color:var(--pink);
    overflow:hidden;
  }

  /* Landing full-screen */
  .full-screen{
    position:fixed;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    z-index:10;
    gap:20px;
  }

  /* Start icon button (pulsing) */
  #startBtn{
    background:transparent;
    border:0;
    cursor:pointer;
    width:130px;
    height:130px;
    padding:0;
    display:inline-block;
    animation:pulse 1.6s infinite ease-in-out;
  }
  #startBtn img{ width:100%;height:100%; display:block; border-radius:14px; }

  @keyframes pulse{
    0%{ transform:scale(1); filter: drop-shadow(0 0 0 rgba(255,105,180,0)); }
    50%{ transform:scale(1.08); filter: drop-shadow(0 0 20px rgba(255,105,180,0.45)); }
    100%{ transform:scale(1); filter: drop-shadow(0 0 0 rgba(255,105,180,0)); }
  }

  /* Ripple - fixed so it spans viewport; initial transform centers it and scale(0) -> scale(1) */
  .ripple{
    position:fixed;
    border-radius:50%;
    pointer-events:none;
    transform:translate(-50%,-50%) scale(0);
    transform-origin:center center;
    /* visual style: thin ring */
    border: 3px solid rgba(255,105,180,0.32);
    background: rgba(255,105,180,0.03);
    z-index:9999;
    animation: rippleExpand 1100ms ease-out forwards;
    animation-fill-mode:both;
  }
  @keyframes rippleExpand{
    0%{ transform:translate(-50%,-50%) scale(0); opacity:1; }
    100%{ transform:translate(-50%,-50%) scale(1); opacity:0; }
  }

  /* Letter container */
  #container{
    max-width:90%;
    width:700px;
    background:var(--white-bg);
    border-radius:12px;
    padding:24px;
    box-shadow:0 4px 15px rgba(250,50,120,0.2);
    margin:80px auto;
    display:none;
    text-align:left;
    position:relative;
    opacity:0;
    transition:opacity .8s ease;
    z-index:1;
  }
  h1{ font-size:2rem; margin-bottom:1rem; }

  #letter{
    font-family:'Great Vibes', cursive;
    font-size:1.8rem;
    color:var(--pink);
    white-space:pre-wrap;
    position:relative;
  }
  #letter p{ margin:1.2em 0; position:relative; }

  /* letter spans */
  #letter p span.letter{
    display:inline-block;
    white-space:pre;
    opacity:0;
    transform:translateY(5px);
    transition: opacity .15s ease, transform .15s ease;
  }

  /* ink-trail */
  .ink-trail{
    position:absolute;
    width:4px;
    height:1.8rem;
    border-radius:50%;
    pointer-events:none;
    background: radial-gradient(circle, rgba(255,105,180,0.6) 0%, rgba(255,105,180,0) 60%);
    opacity:0;
    transition: all .28s ease-out;
  }

  #heart{ font-size:2.3rem; color:#ff4d6d; margin-top:24px; animation:beat 1.2s infinite; text-align:center; }
  @keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.15)} }

  @media (max-width:600px){
    #startBtn{ width:86px; height:86px; }
    #letter p{ font-size:1.4rem; }
    #container{ padding:20px; margin:60px 10px; }
  }
</style>
</head>
<body>

  <!-- Landing -->
  <div id="intro" class="full-screen">
    <h1>üíå You have a letter waiting...</h1>
    <button id="startBtn" aria-label="Open letter">
      <!-- replace with your icon file -->
      <img src="stella.png" alt="start icon">
    </button>
  </div>

  <!-- Letter page -->
  <div id="container" role="main" aria-hidden="true">
    <h1>üíå A Letter for u</h1>
    <div id="letter"></div>
    <div id="heart">‚ù§Ô∏è</div>

    <audio id="background-music" loop>
      <source src="https://github.com/eddiewei-png/letter/raw/refs/heads/main/%E9%83%81%E5%8F%AF%E5%94%AF%E5%8E%BB%E6%9C%89%E9%A3%8E%E7%9A%84%E5%9C%B0%E6%96%B9%E7%94%B5%E8%A7%86%E5%89%A7%E4%B8%BB%E9%A2%98%E6%9B%B2%E9%AB%98%E9%9F%B3%E8%B4%A8%E6%AD%8C%E8%AF%8D%E7%89%88Yisa%20Yu%20x%20%E5%8E%BB%E6%9C%89%E9%A3%8E%E7%9A%84%E5%9C%B0%E6%96%B9%E5%88%98%E4%BA%A6%E8%8F%B2Liu%20Yifei%E6%9D%8E%E7%8E%B0Li%20Xian%20%E4%B8%BB%E6%BC%94.mp3" type="audio/mpeg">
    </audio>
  </div>

<script>
/* --- letter content --- */
const sentences = [
  "Dear [Their Name],",
  "Wherever you are when you read this, I want you to know something simple and true:",
  "I love you.",
  "Not just sometimes, but deeply and always.",
  "You are my calm in chaos, my spark in silence, and my favorite thought.",
  "This letter is here so you can come back to it anytime you need a reminder.",
  "Whenever you miss me or just want to feel loved, this will say it for you:",
  "I love you. I'm with you. I'm proud of u.",
  "Forever yours,",
  "[Your Name]"
];

const letterDiv = document.getElementById('letter');

/* create ink-trails */
const inkTrails = [];
for(let i=0;i<3;i++){
  const s = document.createElement('span');
  s.className = 'ink-trail';
  letterDiv.appendChild(s);
  inkTrails.push(s);
}
let trailIndex = 0;

/* write single character with ink trail movement */
function writeLetter(span, ch){
  return new Promise(resolve=>{
    span.textContent = ch;
    requestAnimationFrame(()=>{
      const jitter = (Math.random()*2 - 1);
      span.style.transform = `translateY(${jitter}px)`;
      span.style.opacity = '1';

      // position ink trail at character's right edge
      const r = span.getBoundingClientRect();
      const containerRect = letterDiv.getBoundingClientRect();
      const ink = inkTrails[trailIndex % inkTrails.length];
      ink.style.left = (r.right - containerRect.left - 1) + 'px';
      ink.style.top = (r.top - containerRect.top) + 'px';
      ink.style.opacity = 1;
      trailIndex++;
      setTimeout(()=>{ ink.style.opacity = 0; }, 420);
    });
    resolve();
  });
}

/* show sentence letter-by-letter */
async function showSentence(sentence, delayMs=180){
  const p = document.createElement('p');
  letterDiv.appendChild(p);
  for(let i=0;i<sentence.length;i++){
    const span = document.createElement('span');
    span.className = 'letter';
    p.appendChild(span);
    await writeLetter(span, sentence[i]);
    await new Promise(r=>setTimeout(r, delayMs));
  }
}

/* show all */
async function showAllText(){
  for(let i=0;i<sentences.length;i++){
    await showSentence(sentences[i], 200);
    await new Promise(r=>setTimeout(r, 300));
  }
  inkTrails.forEach(t => t.style.display='none');
}

/* ---------------- ripple + start logic ---------------- */
const startBtn = document.getElementById('startBtn');

startBtn.addEventListener('click', function (ev){
  // prevent double clicks
  startBtn.disabled = true;

  const rect = startBtn.getBoundingClientRect();
  const centerX = rect.left + rect.width/2;
  const centerY = rect.top + rect.height/2;

  // ripple parameters
  const rippleCount = 5;
  const delayStep = 180; // ms between ripple starts
  // make ripple big enough: diagonal of viewport (so it reaches corners)
  const diagonal = Math.sqrt(window.innerWidth**2 + window.innerHeight**2);
  const size = Math.ceil(diagonal * 2); // px

  for(let i=0;i<rippleCount;i++){
    // create element
    const r = document.createElement('span');
    r.className = 'ripple';
    // set size and position (left/top are center point; CSS translate centers it)
    r.style.width = r.style.height = size + 'px';
    r.style.left = centerX + 'px';
    r.style.top = centerY + 'px';
    // staggered start
    r.style.animationDelay = (i * delayStep) + 'ms';
    // append
    document.body.appendChild(r);
    // cleanup on animation end
    r.addEventListener('animationend', () => { r.remove(); });
  }

  // show letter area when the last ripple STARTS (not after it finishes)
  const showDelay = (rippleCount - 1) * delayStep;
  setTimeout(()=> {
    // hide intro and reveal container
    document.getElementById('intro').style.display = 'none';
    const container = document.getElementById('container');
    container.style.display = 'block';
    // small delay for transition paint
    setTimeout(()=> container.style.opacity = '1', 60);

    // play music & start writing
    const audio = document.getElementById('background-music');
    audio.play().catch(()=>console.log('Autoplay blocked'));
    showAllText();
  }, showDelay);
});
</script>
</body>
</html>
